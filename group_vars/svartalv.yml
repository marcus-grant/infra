---
# pip - no longer works in python 3.11
# pip_installed_packages:
#   - docker


# Networking
svartalv_main_domain: "{{ vault_svartalv_main_domain }}"

# pip
pip_install_docker: true

# Monitoring
## Fail2ban
fail2ban_destemail: "{{ admin_email }}"  # Email to send notifications to
fail2ban_sendername: fail2ban  # Name of sender
fail2ban_sender: "{{ fail2ban_sendername }}@{{ svartalv_main_domain }}"
fail2ban_services:
  - name: sshd
    enabled: true
    port: "{{ ssh_target_port }}"  # Secret hidden in out of tree inventory
    logpath: /var/log/auth.log
    maxretry: 3
    bantime: 600
    findtime: 600

# DB
## PostgreSQL
postgresql_users:  # PostgreSQL users (roles within database system, not Unix owners)
  - name: "{{ admin_user }}"
postgresql_restarted_state: restarted  # [(restarted)|reloaded]
postgresql_service_state: started  # [started] - state after boot
postgresql_service_enabled: true  # [true] - whether systemctl enabled it
postgresql_locales: ['en_US.UTF-8']  # [[en_US.UTF-8]] debian-based only
postgresql_python_library: python3-psycopg2  # [python-psycopg2] use python3-*
postgresql_user: postgres  # [postgres]
postgresql_group: db  # [postgres]
postgres_databases:
  - {name: "{{ admin_user }}", login_user: "{{ admin_user }}"}
### VVVV TODO: Useful to add users for services that will use the database down the line?
### Host based authentication (hba) entries to be added to the pg_hba.conf. This
postgresql_hba_entries:  # variable's defaults reflect the defaults that come with a fresh installation.
  - {type: local, database: all, user: postgres, auth_method: peer}
  - {type: local, database: all, user: "{{ admin_user }}", auth_method: peer}
  # TODO: I'm not sure if the below is advisable but it sounds insecure unfortunately to leave it
  # - {type: local, database: all, user: all, auth_method: peer}
  - {type: host, database: all, user: all, address: '127.0.0.1/32', auth_method: "{{ postgresql_auth_method }}"}
  - {type: host, database: all, user: all, address: '::1/128', auth_method: "{{ postgresql_auth_method }}"}

## MariaDB/MySQL
mysql_user_home: /root
mysql_user_name: root
mysql_user_password: "{{ vault_postgres_root_password }}"
mysql_enabled_on_startup: true
mysql_users:
  - name: "{{ admin_user }}"
    password: "{{ ansible_become_password }}"
    state: present

# Traefik
traefik_base_domain: "{{ svartalv_main_domain }}"
traefik_port_ui: 8083
traefik_acme_email: "{{ admin_email }}"

# Dotfiles
## Bash
bash_set_default_shell: true
dotfiles_bash_git_force: true

## Vim
vim_git_force: true
vim_git_backup: false

## TMux
tmux_git_force: true
tmux_git_backup: false

# Packages
base_packages:
  - fail2ban
  - git
  - ncdu
  - ranger
  - tree
  - tmux
  - vim
